<!DOCTYPE html>
<html lang="en-us" class="wf-firasans-n4-active wf-active">
	<head>
    <link href="http://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- Enable responsiveness on mobile devices -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    
    
    <meta name="generator" content="Hugo 0.59.0" />
    
    <title>机器真的可以学习吗？ &middot; RayG</title>
    <meta content="机器真的可以学习吗？ - RayG" property="og:title">
    <meta content=" - " property="og:description">
    <!-- CSS -->
    
    <link rel="stylesheet" href="https://ray-g.github.io/css/print.css" media="print">
    <link rel="stylesheet" href="https://ray-g.github.io/css/poole.css">
    <link rel="stylesheet" href="https://ray-g.github.io/css/hyde.css">
    <!-- Font-Awesome -->
    <script defer src="https://use.fontawesome.com/releases/v5.0.13/js/all.js" integrity="sha384-xymdQtn1n3lH2wcu0qhcdaOpQwyoarkgLVxC/wZ5q7h9gHtxICrpcaSUfygqZGOe" crossorigin="anonymous"></script>
    <!-- highlight.js-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/monokai.min.css">
    <!-- Customised CSS -->
    <link rel="stylesheet" href="https://ray-g.github.io/css/custom.css">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="/favicon.png">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
    

	</head>
    <body class="theme-base-0d ">
        <div class="sidebar">
  <div class="container text-center ">
    <div class="sidebar-about text-center">
      <a href="https://ray-g.github.io/"><h1 class="brand">RayG</h1></a>
       <img src="/img/rayg.png" alt="Author Image" class="img-circle headshot center"> 
      <p class="lead">
          Tech Notes 
      </p>
    </div>
    
<div>
	<ul class="sidebar-nav">
		
		
				<li>
					<a href="/architect/"> <span>Architect</span></a>
				</li>
				<li>
					<a href="/golang/"> <span>Golang</span></a>
				</li>
				<li>
					<a href="/machinelearning/"> <span>Machine Learning</span></a>
				</li>
				<li>
					<a href="/cloud/"> <span>Cloud</span></a>
				</li>
				<li>
					<a href="/docker/"> <span>Docker</span></a>
				</li>
				<li>
					<a href="/database/"> <span>Database</span></a>
				</li>
				<li>
					<a href="/others/"> <span>Others</span></a>
				</li>
				<li>
					<a href="https://github.com/ray-g"> <span>Codes</span></a>
				</li>
				<li>
					<a href="/about/"> <span>About</span></a>
				</li>
		</li>
	</ul>
</div>

    <p>
      <section class="row text-center">
	
	
	
	&nbsp;<a href="https://github.com/ray-g"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	&nbsp;<a href="https://linkedin.com/in/ray-guo-15145024"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a>
	
	
	&nbsp;<a href="https://stackoverflow.com/users/7188458/ray-g"><i class="fab fa-stack-overflow fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	&nbsp;<a href="mailto:ray_g@live.com"><i class="fas fa-at fa-lg" aria-hidden="true"></i></a>
	
</section>

    </p>
    <p class="copyright">&copy; 2020 RayG.
      <a href="https://creativecommons.org/licenses/by/4.0">Some Rights Reserved</a>.<br/>Built with <a href="https://gohugo.io/">Hugo</a> &amp; <a href="https://github.com/htr3n/hyde-hyde">hyde-hyde</a>.
    </p>
  </div>
  <div>
  </div>
</div>

        <div class="content container">
            <div class="post">
  <h1>机器真的可以学习吗？</h1>
  
  <div class="col-sm-12 col-md-12">
    <span class="text-left post-date meta">
      
      
        <i class="fas fa-calendar-alt"></i> Jun 11, 2018
      
      
      
      
      <br/>
      <i class="fas fa-clock"></i> 8 min read
      </span>
  </div>
  

  
<aside>
    <header>
        <b>Table of Content</b>
    </header>
    
    <p>---</p>
</aside>



  <article>
    <p>在讨论机器是否可以学习之前，我们先来看看下面这个问题</p>

<h2 id="什么是学习">什么是学习？</h2>

<p>在课堂上听老师讲课，是进行学习; 自己通过摸索总结得出经验，也是学习; 小朋友通过模仿大人说话，从而学会说话，也是学习。</p>

<p>人自从出生以后，就一直在学习，一直在通过触觉，视觉以及听觉来观察感受所在的世界，并学习到各种<code>技能</code>，从而更加适应在这个世界中生存。</p>

<p>Herbert A. Simon 曾经对<strong>学习</strong>下过一个定义“<em>如果一个系统能够通过执行某个过程改进它的性能，这就是学习。</em>”</p>

<p>按照此定义，那么人类一直是在进行学习，其实不仅仅是人类，各种动物也是同样的方式在进行着对这个世界的学习。</p>

<p>那么对于机器的话，如果可以通过某种<code>方法</code>来提高机器的某些<code>技能</code>，那么机器也就是学会了<code>学习</code>了。</p>

<p>人是通过观察世界来学习到技能的，那么机器所能得到的只有数据，于是机器只能观察数据，就有了下表：</p>

<pre><code>      人：    观察世界 ----&gt; 通过学习 ----&gt; 技能
    机器：    观察数据 ----&gt; 通过学习 ----&gt; 技能
</code></pre>

<p>人所学得的技能是很好理解的，那么机器学得的是什么技能呢？</p>

<p>实践已经得出结论，机器可以学会如何区分垃圾邮件，识别图片的内容，听懂一段语音等等，并且现在大量的实践可以证明通过一些<code>手段</code>，
机器是可以提高这些各种各样的机器的技能的，所以，实践已经证明，机器是可以学习的，而且学得的技能甚至超越人类的平均水平。</p>

<h2 id="机器真的可以学习吗">机器真的可以学习吗？</h2>

<p>所以机器学习，就是<code>从数据出发，经过一系列的过程，来提高机器在某一个方面的性能。</code></p>

<p>再具体一些，就是机器学习是要根据已有的<code>数据集合 X</code>，且该数据集合通过一种<code>映射关系 f</code>，
使得每一个 <span  class="math">\(x \in X\)</span> 和 <span  class="math">\(y \in Y\)</span> 都可以通过<code>f</code>映射，也就是 <code>y = f(x)</code>。
学习则是人为的给出一组<code>假设集 H</code>，使用<code>数据集合 X</code>，以及<code>目标集合 Y</code>，通过学习方法，
来找到<code>H</code>之中最好的一个<code>g</code>，使得 <span  class="math">\( g(x) \approx f(x) \)</span>。</p>

<p>但是，我们找到的这个<code>g</code>，是针对<code>已知</code>数据<code>X</code>中表现最好的一个，但是现实是我们需要处理的不仅仅是<code>已知的 X</code>，
因为如果仅仅需要处理已知的问题的话，那么将这些记录全部录入电脑就可以了，电脑最擅长的就是记忆了，
我们需要的其实是将<code>g</code>用来对<code>X</code>之外的<code>未知</code>数据集<code>Z</code>做出推论<code>Y‘=g(Z)</code>，我们找到的这个<code>g</code>真的没问题吗？</p>

<p>这个听起来机器学习似乎有点不那么靠谱了。</p>

<p>但是，现实中我们处理的<code>数据</code>是<code>独立同分布</code>的数据，即每个数据<code>个体</code>不会影响其它个体，且每个数据的<code>个体</code>的分布都是一样的，
这样才有一定的<code>模式</code>可供我们来学习，否则个体互相关联或分布都不一样的话，那每一个个体都是单独且互相不一样的存在，是无规律可言的。</p>

<p>在<code>独立同分布</code>的前提下，那么我们要处理的数据集<code>X</code>其实就是未知数据集<code>Z</code>的一个采样，也就是<span  class="math">\( X \in Z \)</span>。
我们要做的事情，也就是需要通过样本来推断整体，通过身边的已知事物来认识这个世界。听起来要好多了，因为我们人类一直都是这样做的。</p>

<h2 id="数学的证明">数学的证明</h2>

<h3 id="坏事情发生的概率很低">坏事情发生的概率很低</h3>

<p>在概率论中，有一个已经被证明了的定理，Hoeffding’s Inequality (霍夫丁不等式)。</p>

<p>\[ \mathbb{P}[|\nu - \mu| &gt; \epsilon] \leq 2exp(-2\epsilon^{2}N) \]</p>

<p>该不等式的意思是，取<span  class="math">\(N\)</span>个样本，那么总体的中取得Y概率<span  class="math">\(\mu\)</span>，
与样本中取得Y的概率<span  class="math">\(\nu\)</span>的误差大于<span  class="math">\(\epsilon\)</span>的几率会不大于这个值：<span  class="math">\(2exp(-2\epsilon^{2}N)\)</span>。</p>

<p>通俗的讲，该不等式表示一个坏事情——<code>样本与总体中取得同一种个体的概率的误差，大于可接受的值</code>——发生的概率，是有上限的，
而且这个上限仅与<code>误差值</code>以及样本大小<code>N</code>相关，与其他统统不相关。因为有个<code>exp</code>在，那么随着<code>N</code>的增大，
这个坏事情发生的几率就会程指数级的减小，当N足够大的时候，这个几率就变的非常非常的小了。</p>

<p>回到机器学习，我们在假设集<code>H</code>中任意取一个假设<code>h</code>，并且可以在已有的样本个数为<code>N</code>的样本数据集<code>D</code>上对其进行验证，
得到样本内错误 <span  class="math">\( E_{in}(h) = \frac{1}{N}\sum_{n=1}^N[[h(x_{n}) \neq y_{n}]] \)</span>，
对于由<code>独立同分布 P</code>产生的样本集，那么对于样本外的错误 <span  class="math">\( E_{out}(h) = \varepsilon_{x\sim P}[[h(x) \neq f(x)]] \)</span>，
将其带入 Hoeffding‘s Inequality：</p>

<p>\[ \mathbb{P}[|E_{in} - E_{out}| &gt; \epsilon] \leq 2exp(-2\epsilon^{2}N) \]</p>

<h3 id="可以开始学习了吗">可以开始学习了吗？</h3>

<p>这样只要找到最小的那个<span  class="math">\(E_{in}\)</span>我们就能进行机器学习了吗？</p>

<p>等等，霍夫丁给我们的保证只是随机抽一个个体，对于一个<code>h</code>来说，那么这个个体是坏事情的概率够小。
现在我们要做的事情是提供<code>M</code>个<code>h</code>的集合<code>H</code>，并希望在<code>H</code>中找到最好的那一个<code>g</code>，那么该如何选呢？</p>

<p>我们现在需要定义一个演算法<code>A</code>，我们希望可以通过这个演算法<code>A</code>从<code>M</code>个<code>h</code>中找到那个最好的<code>g</code>，这可能吗？
霍夫丁只能针对一个<code>h</code>作出保证，但是现在有<code>M</code>个<code>h</code>，一旦任意一个数据个体在任意一个<code>h</code>上表现不好，
那么这个数据个体都会对<code>A</code>产生不好的影响，我们希望<code>A</code>能正常运作，那么需要看一下最坏的情况有多坏。</p>

<p>\[ \mathbb{P_{D}}[ D_{bad_{all}} ] \]
\[ = \mathbb{P_{D}}[ D_{badh_{1}} or D_{badh_{2}} or ... or D_{badh_{M}} ] \]
\[ \leq \mathbb{P_{D}}[ D_{badh_{1}} ] + \mathbb{P_{D}}[ D_{badh_{2}} ] + ... + \mathbb{P_{D}}[ D_{badh_{M}} ] \] (union bound)
\[ \leq 2exp(-2\epsilon^2N) + 2exp(-2\epsilon^2N) + ... + 2exp(-2\epsilon^2N) \]
\[ = 2Mexp(-2\epsilon^2N) \]</p>

<p>也就是说，如果<code>H</code>为有限集，那么只要<code>N</code>够大，演算法<code>A</code>就一定能找到一个足够好的假设<code>g</code>。
只要找到最小样本内错误的一个假设，也就可以认为是最好的那个假设<code>g</code>，从而实现了机器学习。</p>

<h3 id="好像还缺些什么">好像还缺些什么</h3>

<p>只能有<code>M</code>个有限假设？那么<code>M</code>最大能是多少？</p>

<p><code>M</code>在比较小的时候，坏事情发生的概率确实很小，但是只是能保证说 <span  class="math">\( E_{in} \)</span> 与 <span  class="math">\( E_{out} \)</span> 差别不大，
但是无法保证这个最小的<span  class="math">\( E_{in} \)</span>就是一个好到能够使用的<code>h</code>。那么要想找到一个合适的<code>h</code>，就需要增大假设集，
但是随着<code>M</code>的增大，那么坏事情发生概率就会直线的增加。目前我们的不等式如下：</p>

<p>\[ \mathbb{P}[|E_{in} - E_{out}| &gt; \epsilon] \leq 2Mexp(-2\epsilon^2N) \]</p>

<p>我们希望能够一定找到一个比较好的<code>h</code>，那么在<code>M</code>个假设中，坏事情发生的总的概率是多少呢？</p>

<p>我们定义 <code>Bad event</code> <span  class="math">\( B_{m} : |E_{in}(h_{m}) - E_{out}(h_{m})| \)</span></p>

<p>那么，当事情到了最坏的地步，就是所有的坏事情坏的都不一样，也就是说，所有的 <span  class="math">\( B_{m} \)</span> 都不重复，那么：</p>

<p>\[ \mathbb{P}[B_{1} or B_{2} or ... or B_{m}] \leq \mathbb{P}[B_{1}] + \mathbb{P}[B_{2}] + ... + \mathbb{P}[B_{m}] \]</p>

<p>那这样当<code>M</code>趋于无限大的时候，那么坏事情的上限也就无限大了。</p>

<p>这样岂不是当<code>M</code>比较大的时候就无法进行学习了？</p>

<p>那么我们做错了什么吗？</p>

<p>其实，在定义假设集的时候，其实定义的是有限的几组很相似的函数，也就是说，绝大部分的假设<code>h</code>，其实应该是重叠的，
所以我们在使用union bound估计坏事情的时候，其实是过估计了。那么<code>N</code>个点如果进行分类的话最多只有<code>N</code>种类别，
针对每一种类别，那一组的<code>h</code>应该都是几乎一样的，这样我们可以假设有一个函数 <span  class="math">\( m_{h}(N) \)</span>，
用来表示随着<code>N</code>的增大，<code>H</code>中有效<code>h</code>的个数，那么，之前的不等式可以替换为：</p>

<p>\[ \mathbb{P}[\exists h \in H\, s.t. |E_{in}(h) - E_{out}(h)| &gt; \epsilon] \leq 2 \cdot m_{h}(N) \cdot exp(-2\epsilon^2N) \]</p>

<p>由于我们目前无法验证 <span  class="math">\( E_{out} \)</span>，我们取一个巧，我们再用同样的方式取另一个同样有<code>N</code>个数据的数据集<code>D'</code>，
同时计算出对于<code>D'</code>的误差，记为<span  class="math">\( E^\prime_{in} \)</span>，然后来计算<span  class="math">\( E^\prime_{in} \)</span>与<span  class="math">\( E_{in} \)</span>的差距。
由于大家都是独立同分布的数据，那么我们可以认为 <code>BAD h</code> of <span  class="math">\( | E_{in} - E_{out} | \frac{\rightarrow}{probably} \)</span> <code>BAD h</code> of <span  class="math">\( | E_{in} - E^\prime_{in} | \)</span>。那么，带入之前的不等式则有：</p>

<p>\[ \frac{1}{2}\mathbb{P}[\exists h \in H\, s.t. |E_{in}(h) - E_{out}(h)| &gt; \epsilon] \]
\[ \leq \mathbb{P}[\exists h \in H\, s.t. |E_{in}(h) - E^\prime_{in}(h)| &gt; \frac{\epsilon}{2}] \]</p>

<p>因为是随机取出的<code>D'</code>，所以<span  class="math">\( E^\prime_{in} \)</span>有很大的概率不怎么好，这个概率就是第一个 <span  class="math">\( \frac{1}{2} \)</span>，
那么我们想让坏事情出现的概率更严格，于是在不等式的右边也/2。</p>

<p>现在，我们有了两个<code>N</code>个数据的数据集<code>D</code>以及<code>D'</code>，那么再把我们的<span  class="math">\( m_{h}(N) \)</span>请回来，则现在是<span  class="math">\( m_{h}(2N) \)</span>，
那么，坏事情发生的概率</p>

<p>\[ BAD \leq 2\mathbb{P}[\exists h \in H\, s.t. |E_{in}(h) - E^\prime_{in}(h)| &gt; \frac{\epsilon}{2}] \]
\[ \leq 2m_{h}(2N)\mathbb{P}[fixed\, h\, s.t. |E_{in}(h) - E^\prime_{in}(h)| &gt; \frac{\epsilon}{2}] \]</p>

<p>现在，无限多个的<code>H</code>变成了 <span  class="math">\( |H(x_1,...,x_{N},x^\prime_{1},...,x^\prime_{N})| \)</span>，union bound 为 <span  class="math">\(m_{h}(2N)\)</span>，
再把Hoeffding请回来，考虑现在的数据集为<code>2N</code>，且一半的数量<code>N</code>是计算<span  class="math">\(E_{in}\)</span>的，剩下的另一半则是计算了<span  class="math">\(E^\prime_{in}\)</span>，
那么则有 <span  class="math">\( |E_{in} - E^\prime_{in} | > \frac{\epsilon}{2} \leftrightarrow |E_{in} - \frac{E_{in}+E^\prime_{in}}{2}| > \frac{\epsilon}{4}\)</span>，我们仅仅是用了稍微小一些的数据集<code>2N</code>，稍微小一些的<span  class="math">\(\epsilon\)</span>，带回不等式中得到：</p>

<p>\[ BAD \leq 2m_{h}(2N)\mathbb{P}[fixed\, h\, s.t. |E_{in}(h) - E^\prime_{in}(h)| &gt; \frac{\epsilon}{2}] \]
\[ \leq 2m_{h}(2N) \cdot 2exp(-2(\frac{\epsilon}{4})^2N) \]</p>

<p>这个也就是著名的 Vapnik-Chervonenkis (VC) bound, 我们把上面的不等式稍微整理一下：</p>

<p>\[ \mathbb{P}[\exists h \in H\, s.t.|E_{in}(h) - E_{out}(h)| &gt; \epsilon] \leq 4 \cdot m_{h}(2N) \cdot exp(-\frac{1}{8} \cdot \epsilon^2N) \]</p>

<p>所以，随着<code>M</code>的增大，其实是不需要担心的，我们之前定义的通过选最小的 <span  class="math">\( E_{in} \)</span> 演算法<code>A</code>，其实还是能找到最好的<code>g</code>的。</p>

<p>所以，机器学习是可行的。</p>

<h2 id="为什么需要机器学习">为什么需要机器学习？</h2>

<p>回想一下，人类社会为什么需要工具？ 狩猎没有工具的话，徒手打不过猛兽; 耕地没有工具的话，徒手开垦荒地几乎不可能。</p>

<p>再考虑一下，人类社会为什么需要机器？ 织布机替代了大量的纺织工人，流水线替代了大量的装配工人。</p>

<p>自古以来，人类一直在创造着能帮助人类更加进步的工具，而能创造出能够自主思考的机器，则是发明家一直以来的梦想。
尤其是随着人类社会的进步，社会要快速发展，人类需要更加强大的有一定自主性而不是只会执行固定指令的机器来帮助自己。
比如一下一些场景：火星漫步者号在火星该怎么行走，遇到坑的话怎么绕过去？总不能一直由NASA的工程师盯着指挥吧，
信号从火星到地球一个来回需要数十分钟。想标注十万张图片中的物品，判断图片中有什么物品对人来说很容易，
但是人却很难对计算机下个定义什么是树，什么是猫。购物网站需要对数千万的用户推荐可能购买的物品，
雇佣大量的人来分析数千万用户每一个人的喜好是完全不现实的事情。</p>

<p>对于这些很难由人类做出定义或者很难实现的事情，但是又需要完成这样的工作，那么就需要机器的帮助，并且这个机器是要会学习的机器。</p>

<h2 id="什么时候可以应用机器学习">什么时候可以应用机器学习？</h2>

<p>机器学习是机器通过对<code>数据</code>进行一系列的<code>计算</code>过程，得到<code>性能提升</code>。那么符合以下个条件的话，就适合应用机器学习：</p>

<ol>
<li>存在一种<code>模式</code>可以被总结并学得，否则机器无从学起</li>
<li>无法通过<code>编程</code>的方式来解决问题，否则直接写程序就可以了</li>
<li>存在<code>数据</code>可以用来学习，否则巧妇难为无米之炊</li>
</ol>

  </article>
    
    
</div>

            <div class="footer">
                <script src="https://unpkg.com/mermaid@8.4.8/dist/mermaid.min.js?1583991206"></script>
<script>
    mermaid.initialize({
        theme: 'default',  
        startOnLoad: true
    });
    (function() {
        var codelist = document.querySelectorAll('code.language-mermaid');
        if (codelist && 'length' in codelist && codelist.length > 0) {
            for (var i = 0; i < codelist.length; i++) {
            var div = document.createElement('div');
            div.className = 'mermaid';
            div.setAttribute('align', 'center');
            div.innerHTML = codelist[i].innerHTML.replace(/&amp;/g, '&');
            codelist[i].replaceWith(div);
        }
    }
    })();
</script>

    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>

<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/go.min.js"></script>

<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>

<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/dockerfile.min.js"></script>

<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/python.min.js"></script>

<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/toml.min.js"></script>

<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/java.min.js"></script>

<script type="text/javascript">
    hljs.configure({languages: []});
    hljs.initHighlightingOnLoad();
</script>

    
<div id="graphcomment"></div>
<script type="text/javascript">
  window.graphcomment_id = 'ray-g-github-io';
  (function() {

    
    
    
    if (location.hostname === "localhost" ||
       	location.hostname === "127.0.0.1" ||
       	location.hostname === "") {
        return;
		}

     
    var gc = document.createElement('script'); gc.type = 'text/javascript'; gc.async = true;
    gc.src = 'https://graphcomment.com/js/integration.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(gc);
  })();
</script>

            </div>
        </div>
        
        
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-121338579-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

    </body>
</html>
